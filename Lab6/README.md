# README

## Описание проекта

Данный проект содержит реализацию пользовательских функций в MySQL для базы данных железнодорожной станции "Новосибирск-Главный". Функции предназначены для анализа информации о билетах и доступных местах на поездах.

## Функции

### 1. GetAvailableSeats
**Описание:**
Функция `GetAvailableSeats` вычисляет количество доступных мест на поезде по заданному маршруту и дате отправления.

**Входные параметры:**
- `p_route` (VARCHAR(500)) – маршрут поезда (две основные станции).
- `p_departure` (DATETIME) – время отправления.

**Возвращаемое значение:**
- Количество доступных мест (INT).

**Логика работы:**
1. Определяет `train_id` по маршруту и времени отправления.
2. Получает тип поезда (`Скорый` – 180 мест, `Пассажирский` – 150 мест).
3. Определяет количество уже забронированных мест.
4. Возвращает разницу между общим количеством мест и забронированными.

**Пример вызова:**
```sql
SELECT GetAvailableSeats('Новосибирск-Главный - Бердск', '2024-10-10 08:00:00') AS Скорый;
SELECT GetAvailableSeats('Новосибирск-Главный - Обь', '2024-10-11 09:00:00') AS Пассажирский;
```

### 2. CountTicketsByStatus
**Описание:**
Функция `CountTicketsByStatus` подсчитывает количество билетов для каждого статуса в таблице `Tickets`.

**Входные параметры:**
- Нет входных параметров.

**Возвращаемое значение:**
- Строка с перечислением статусов и количеством билетов для каждого из них (VARCHAR(500)).

**Логика работы:**
1. Перебирает все уникальные статусы билетов с помощью курсора.
2. Для каждого статуса вычисляет количество билетов.
3. Формирует строку вида `<статус>: <количество>;`.
4. Возвращает итоговую строку.

**Пример вызова:**
```sql
SELECT CountTicketsByStatus() AS TicketCounts;
```

## Тестирование
Для проверки корректности работы функций проводилось позитивное и негативное тестирование:
1. Запросы с корректными параметрами – проверка ожидаемых результатов.
2. Запросы с некорректными параметрами (несуществующий маршрут, отсутствие билетов и т. д.).
3. Проверка работы курсоров и обработки возможных исключений.

## Выводы
- Реализованные функции позволяют получать полезную аналитическую информацию о билетах и доступных местах.
- Функция `GetAvailableSeats` позволяет определить, сколько мест осталось в поезде.
- Функция `CountTicketsByStatus` предоставляет сводку о статусах билетов.
- Проведённое тестирование показало корректность работы обеих функций.

## Запуск функций
Для использования функций необходимо выполнить соответствующие SQL-запросы в MySQL.
